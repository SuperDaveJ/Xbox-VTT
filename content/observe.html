<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0021)http://www.ngrain.com -->
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<title>Xbox Support Portal - Observe</title>
	<link href="css/main_style.css" rel="stylesheet" type="text/css">
	<script type="text/javascript" language="javascript" src="javascript/main_javascript.js"></script>
	<script language="javascript" src="javascript/PartsTree.js"></script>
	<script language="javascript" src="javascript/ControlLoader.js"></script>
	<script language="javascript" src="javascript/FlashModeButtonsControl.js"></script>
	<script language="javascript" src="javascript/animation.js"></script>
	<script language="javascript" src="javascript/parts.js"></script>
	<script language="javascript" src="javascript/jquery-1.8.2.js"></script>
	<script language="javascript" src="javascript/jquery-ui.js"></script>
	<script type="text/javascript">
		function initMenu() {
			$(function() {        
				$( "#tasks" ).accordion({            
					collapsible: "true",
					heightStyle: "content"		
				});    
			});
		}
	</script>
</head>
<body onLoad="StartUp()" onResize="Resize()">
<div class="home_link"><a href="../index.html"><img src="images/spacer.gif" alt="Home" width="70" height="68" border="0"></a></div>
<table width="100%" style="height: 100%" border="0" cellpadding="0" cellspacing="0">
	<tr>
		<td style="height: 101px" align="left" valign="top">
		
			<!-- navigation table start -->
			<table class="navigation" width="100%" style="height: 101px" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="left" valign="top" class="tabs_bkg_2" style="">
						<table width="100%" style="height: 101px" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td colspan="10" valign="middle">
									<div class="maintitle">Support Portal <span style="font-size:13px"> <br>
										Setup of the Xbox 360 Console, 360S Console, Kinect and Accessories</span></div>
								</td>
							</tr>
							<tr>
								<td width="204" height="22">&nbsp;</td>
								<td width="125" align="center" valign="middle"><a href="explore.html">Explore</a></td>
								<td width="22">&nbsp;</td>
								<td width="135" align="center" valign="middle">Observe</td>
								<td width="22">&nbsp;</td>
								<td width="141" align="center" valign="middle"><a href="practice.html">Hardware Practice</a></td>
								<td width="23">&nbsp;</td>
								<td width="151" align="center" valign="middle"><a href="LIVE.html">LIVE Practice</a></td>
								<td align="right"></td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
			<!-- navigation table stop -->
			
		</td>
	</tr>
	<tr>
		<td align="left" valign="top" style="padding:8px">
			<table width="100%" style="height: 100%" border="0" cellpadding="0" cellspacing="0" >
			
				<tr>
					<td width="247" align="left" valign="top" class="tablestas">
					
						<!-- left part table start -->
						<table class="lft_tbl_explore" width="100%" style="height: 100%" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td height="10" align="left" valign="top" class="instructions">Here you will learn how to setup your Xbox 360, 360S Console, Kinect and accessories by clicking the name of an animation in the list below.</td>
							</tr>
							<tr>
								<td class="top_title">Animations</td>
							</tr>
							<tr>
								<td>
									
									<div id="tree" class="animations" style="overflow-x:hidden;">
										<!-- tree start -->
										<table border="0" cellpadding="0" cellspacing="0" width="100%" style="height:100%;font-size:12px;">
											<tr>
												<td colspan="2" align="left" valign="top" >
														<div id="tasks" class="parts_tree">
														</div>
												</td>
											</tr>
										</table>
										<!-- tree stop -->
									</div>
								</td>
							</tr>
							<tr>
								<td class="bottom_bar">&nbsp;</td>
							</tr>		
							<tr>
								<td height="5" align="center" valign="top" style=""></td>
							</tr>
							<tr>
								<td width="135" height="35" align="left" valign="top" style="padding-left:10px" > 
								  <img src="images/ani_play.gif" alt="Play the selected animation" name="play" id="play" onClick="PlayAnimationButton();" onMouseOver="PlayOver();" onMouseOut="PlayOut();"> 
								  <img src="images/ani_pause.gif" alt="Pause the currently playing animation" name="pause" id="pause" onClick="PauseAnimation();" onMouseOver="PauseOver();" onMouseOut="PauseOut();"> 
								  <img src="images/ani_stop.gif" alt="Stop the currently playing animation" name="stop" id="stop" onClick="StopAnimation();" onMouseOver="StopOver();" onMouseOut="StopOut();">												</td>
							</tr>					
						</table>
						<!-- left part table stop -->
						
					</td>
					<td width="10" align="left" valign="top">
					
						<!-- Flash buttons table start -->
						<table width="100%" style="height: 100%" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td align="left" valign="top" class="flash_buttons">
								  <img src="images/help_button.gif" alt="Help" name="help" id="help" style="margin-left:5px; margin-top:-90px;" onMouseOver="MM_swapImage('help','','images/help_button_hover.gif',0)" onMouseOut="MM_swapImgRestore()" onClick="instructions()">							
							    <div id="FlashModeButtonsDiv">
                     <script language="javascript">
                       CreateFlashControl("FlashModeButtonsDiv", "FlashModeButtons", 390, 55, "Media/ModeButtons.swf");
                     </script>
                   </div>
								</td>
							</tr>
							<tr>
								<td class="flash_buttons_bottom_bkg" >&nbsp;</td>
							</tr>
						</table>
						<!-- Flash buttons table stop -->
						
					</td>
					<td align="left" valign="top" style="border-top:1px solid #DADADA; border-right:1px solid #DADADA; border-bottom:1px solid #DADADA; background-color:#FFFFFF ">
						
						<!-- right part table start -->
						<table width="100%" style="height: 100%" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td class="main_mobilizer">
								
									<!-- mobilizer main object start -->
									<div id="MobilizerDiv">
 									  <script language="javascript">
 									    CreateMobilizerControl("MobilizerDiv", "Mobilizer", 515, 480, "visibility: hidden;")
 									  </script>
 									</div>
									<!-- mobilizer main object stop -->
									
								</td>
							</tr>
						</table>
						<!-- right part table stop -->
						
					</td>
				</tr>
			</table>
			
		</td>
	</tr>
</table>

<div id="ControlDisabler" style="visibility:hidden; filter: alpha(opacity=60); position: absolute; left: 9px; width: 247px; height: 100%; background-color: white;"></div>
<div id="TabDisabler" style="visibility:hidden; position:absolute; top:80; left:200; width:445; height:17; background-image: url(../images/tabs_2.png)"></div>

</body>
<iframe id="loadingDiv" name="loadingDiv" src="LoadingImage.html" marginwidth="0" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" style="position: absolute; left: 325px; top: 118px; width: 118; height: 106;"></iframe>

</html>

<script language="javascript">
var loading = true;
var ContinuousPlay = true;

// This is used to allow the loadingdiv to get parsed
function SetLoading()
{
  try
  {  
    document.getElementById('loadingDiv').contentWindow.SetBackColor("rgb(224,224,224)");
    document.getElementById('loadingDiv').contentWindow.SetText("<font face='arial'><h2>Observe</h2><p>In this section, you will observe a series of 3D animations featuring<br />the Xbox 360, Xbox 360S, Kinect, Accessories and Network setup.<br />Select an animation from the list</p></font>");
  }
  catch(exp)
  {
    self.setTimeout("SetLoading()", 100);    
  }
}

function DoneLoad()
{  
  document.getElementById('FlashModeButtons').attachEvent("FSCommand", ModeButtonsFSCommand);
  
  //set the tool for the main mobilizer to rotate world
  //it is done using this method because this also sets the
  //rotateworld button the flash to become selected as well
  try {
    //[NGRAIN] error with this call is cause the rest of the script to fail. Using try catch to bypass.
    FlashModeButtons.TCallLabel("/", "MoveParts");
  } 
  catch(e) {} 
  
  InitAnimations(Mobilizer, null, document.getElementById('tasks'), 
    document.getElementById('play'), document.getElementById('pause'), document.getElementById('stop'), document);
    
  var t = document.getElementById('tasks');
  t.innerHTML = "";
  var i;
  for(i = 0 ; i < Animations.length ; i++)
  {
    if( i == 0 ) t.insertAdjacentHTML("BeforeEnd", "<div class='title'>Connecting Cables to an Xbox 360</div><div id='taskgroup0' class='task'></div>");
	else if( i == 5 ) t.insertAdjacentHTML("BeforeEnd", "<div class='title'>Connecting Cables to an Xbox 360S</div><div id='taskgroup1' class='task'></div>");
	else if( i == 10 ) t.insertAdjacentHTML("BeforeEnd", "<div class='title'>Connecting / Removing Accessories to an Xbox 360</div><div id='taskgroup2' class='task'></div>");
	else if( i == 18 ) t.insertAdjacentHTML("BeforeEnd", "<div class='title'>Connecting / Removing Accessories to an Xbox 360S</div><div id='taskgroup3' class='task'></div>");
	else if( i == 22 ) t.insertAdjacentHTML("BeforeEnd", "<div class='title'>Connecting Kinect</div><div id='taskgroup4' class='task'></div>");
	else if( i == 24 ) t.insertAdjacentHTML("BeforeEnd", "<div class='title'>Connecting Networking devices to an Xbox 360</div><div id='taskgroup5' class='task'></div>");
	else if( i == 30 ) t.insertAdjacentHTML("BeforeEnd", "<div class='title'>Connecting Networking devices to an Xbox 360S</div><div id='taskgroup6' class='task'></div>");
	else if( i == 32 ) t.insertAdjacentHTML("BeforeEnd", "<div class='title'>Data Migration</div><div id='taskgroup7' class='task'></div>");
	
	if(Animations[i] != null)
    {
      if( i >= 0 && i < 5) document.getElementById('taskgroup0').insertAdjacentHTML("BeforeEnd", "<div class='item'><span class='taskname'><a id='taskLink|"+Animations[i]+"' href=\"javascript:TaskPlay("+Animations[i]+")\"> "+Tasks[Animations[i]]+"</a></span><div id='stepBox|"+Animations[i]+"'><ol class='stepsList' id='steps|"+Animations[i]+"'></ol></div></div>");   
      else if( i >= 5 && i < 10 ) document.getElementById('taskgroup1').insertAdjacentHTML("BeforeEnd", "<div class='item'><span class='taskname'><a id='taskLink|"+Animations[i]+"' href=\"javascript:TaskPlay("+Animations[i]+")\"> "+Tasks[Animations[i]]+"</a></span><div id='stepBox|"+Animations[i]+"'><ol class='stepsList' id='steps|"+Animations[i]+"'></ol></div></div>");   
	  else if( i >= 10 && i < 18 ) document.getElementById('taskgroup2').insertAdjacentHTML("BeforeEnd", "<div class='item'><span class='taskname'><a id='taskLink|"+Animations[i]+"' href=\"javascript:TaskPlay("+Animations[i]+")\"> "+Tasks[Animations[i]]+"</a></span><div id='stepBox|"+Animations[i]+"'><ol class='stepsList' id='steps|"+Animations[i]+"'></ol></div></div>");   
	  else if( i >= 18 && i < 22 ) document.getElementById('taskgroup3').insertAdjacentHTML("BeforeEnd", "<div class='item'><span class='taskname'><a id='taskLink|"+Animations[i]+"' href=\"javascript:TaskPlay("+Animations[i]+")\"> "+Tasks[Animations[i]]+"</a></span><div id='stepBox|"+Animations[i]+"'><ol class='stepsList' id='steps|"+Animations[i]+"'></ol></div></div>");   
	  else if( i >= 22 && i < 24 ) document.getElementById('taskgroup4').insertAdjacentHTML("BeforeEnd", "<div class='item'><span class='taskname'><a id='taskLink|"+Animations[i]+"' href=\"javascript:TaskPlay("+Animations[i]+")\"> "+Tasks[Animations[i]]+"</a></span><div id='stepBox|"+Animations[i]+"'><ol class='stepsList' id='steps|"+Animations[i]+"'></ol></div></div>");   
	  else if( i >= 24 && i < 30 ) document.getElementById('taskgroup5').insertAdjacentHTML("BeforeEnd", "<div class='item'><span class='taskname'><a id='taskLink|"+Animations[i]+"' href=\"javascript:TaskPlay("+Animations[i]+")\"> "+Tasks[Animations[i]]+"</a></span><div id='stepBox|"+Animations[i]+"'><ol class='stepsList' id='steps|"+Animations[i]+"'></ol></div></div>");   
	  else if( i >= 30 && i < 32 ) document.getElementById('taskgroup6').insertAdjacentHTML("BeforeEnd", "<div class='item'><span class='taskname'><a id='taskLink|"+Animations[i]+"' href=\"javascript:TaskPlay("+Animations[i]+")\"> "+Tasks[Animations[i]]+"</a></span><div id='stepBox|"+Animations[i]+"'><ol class='stepsList' id='steps|"+Animations[i]+"'></ol></div></div>");   
	  else document.getElementById('taskgroup7').insertAdjacentHTML("BeforeEnd", "<div class='item'><span class='taskname'><a id='taskLink|"+Animations[i]+"' href=\"javascript:TaskPlay("+Animations[i]+")\"> "+Tasks[Animations[i]]+"</a></span><div id='stepBox|"+Animations[i]+"'><ol class='stepsList' id='steps|"+Animations[i]+"'></ol></div></div>");   
	  
      var j;
      for(j = 0 ; j < Steps[Animations[i]][0].length ; j++)
      {
        if(Steps[Animations[i]][0][j] != null && Steps[Animations[i]][0][j] != "")
        {
          document.getElementById("steps|"+Animations[i]).insertAdjacentHTML("BeforeEnd","<li class='step'><a id='taskStepText|"+Animations[i]+"|"+j+"' href='javascript:PlayAnimation("+Animations[i]+","+j+",false);'>"+Steps[Animations[i]][0][j]+"</a></li>");
        }
      }
      
      //t.insertAdjacentHTML("BeforeEnd", "<br />");
    }
		
  }
    
  TaskHideAllSteps();  
}

//function hides all the steps for the tasks
function TaskHideAllSteps()
{
	var index = 0;
	for(i = 0 ; i < Animations.length ; i++)
	{
    var element = document.getElementById('steps|' + Animations[i]);
	  if(element != null)
	  {	
		  element.style.display = 'none';
	  }
	}
}

// tells Mobilizer to play a specific task
function TaskPlay(taskID)
{	
  document.getElementById('loadingDiv').style.visibility = "hidden";

  loading = true;
  if(Mobilizer.FileName != "")
  {
    StopAnimation();
  }

  ControlDisabler.style.visibility = "visible";
  TabDisabler.style.visibility = "visible";
    
  document.getElementById('Mobilizer').style.visibility = "visible";
    
	// clear out old one
	TaskHideAllSteps();
	
	var stepIndex = 0;
	var spanner = document.getElementById('taskStepText|' + taskID + '|' + stepIndex);
	while (spanner != null)  
	{
	  spanner.className = "";
	  //spanner.style.color = "#57A822";
	  stepIndex++;
	  spanner = document.getElementById('taskStepText|' + taskID + '|' + stepIndex);
	}		
		
	var spanner = document.getElementById('taskStepText|' + taskID + '|0');
	spanner.className = "stepRunning";
	spanner.style.color = "red";

	// open menu on the page
	document.getElementById('steps|' + taskID).style.display = '';
	
	 // setup auto-scrolling to the task steps say in view
	if(taskID >= 10)
	{
	  for(var i = 0 ; i < 20 ; i++)
	  {
	    document.getElementById("tree").scrollTop += 10;
	  }
	}
	
	self.setTimeout('LoadMobilizer('+taskID+')',1000);
}

function LoadMobilizer(taskID)
{
  try
  {      
    if(taskID == TaskIndex)
    {  
      TaskIndex = taskID;
    }
    else
    {      
      if(Mobilizer != null)
      {
        DisposeParts(Mobilizer);
        Mobilizer.UnloadFile();
      }

      TaskIndex = taskID;
	  
	  // Croes
	  //alert(Tasks3KO[TaskIndex])
	  //alert("VPE"+(TaskIndex-2));
	  
      Mobilizer.FileName = "models/"+Tasks3KO[TaskIndex];
      Mobilizer.CurrentConfiguration = "VPE"+(TaskIndex-2)+" Procedure";
      
      try
      { 
        // this checks if the user hit the cancel button in mobilizer
        if(Mobilizer.FileName == "")
        {
          TaskHideAllSteps();
          document.getElementById("Mobilizer").style.visibility = "hidden";
          TaskIndex = -1;
          
          document.getElementById('loadingDiv').style.visibility = "visible";
        }      
      }
      catch(exp)
      {
      }
      
      Mobilizer.UserInterfaceController.ToolbarVisible = false;
    }  
    
    ControlDisabler.style.visibility = "hidden";
    TabDisabler.style.visibility = "hidden";
    
    MaxSteps = 0;
	  while(AdditionalInstructions[TaskIndex][0][MaxSteps] != null)
	  {
	    MaxSteps++;	
	  }
	  MaxSteps--;	
    
    PlayAnimation(TaskIndex, 0, true);
    loading = false;
  }
  catch(exp)
  {
    // ignore any errors
  }
}

function StepPlay(taskID, stepID, continousPlay)
{
  Mobilizer.detachEvent("AnimationPlaybackStopped", ContinuousAnimationPlaybackStopped);
  
  var spanner = document.getElementById('taskStepText|' + TaskIndex + '|' + CurrentStep);
	if (spanner != null)  
	{
	  spanner.className = "step";
	  spanner.style.color = "#57A822";
	}
	
	var spanner = document.getElementById('taskStepText|' + TaskIndex + '|' + stepID);
	if (spanner != null)  
	{
	  spanner.className = "stepRunning";
	  spanner.style.color = "red";
	}
	
  ContinuousPlay = continousPlay;
  	  
  TaskIndex = taskID;
  CurrentStep = stepID;  
        
  if(CurrentStep < MaxSteps)
  {
	Mobilizer.AnimationController.Stop();
	
	//Croes
	//alert(VPEProcStepAnim[TaskIndex][CurrentStep])
	
    Mobilizer.AnimationController.PlayAnimation(VPEProcStepAnim[TaskIndex][CurrentStep]);
    if(ContinuousPlay)
    { 
      Mobilizer.attachEvent("AnimationPlaybackStopped", ContinuousAnimationPlaybackStopped);
    }
  }
  else
  {
    CurrentStep = 0;
  }
}

function ContinuousAnimationPlaybackStopped(sender, args)
{
  Mobilizer.detachEvent("AnimationPlaybackStopped", ContinuousAnimationPlaybackStopped);
  
  // this fixes bugzid:22893
  self.setTimeout("PlayAnimation("+TaskIndex+", "+(CurrentStep+1)+", "+ContinuousPlay+")",100);
}

//this function is called when a task's step has been successfully completed
function TaskStepSucceeded(taskID, stepIndex)
{  
	// set check mark
	var spanner = document.getElementById('taskStepText|' + taskID + '|' + stepIndex);
	spanner.className = "stepComplete";
		
	// show user success (Mobilizer already does this if a message is defined)
	//if ('' != successMessage) alert(successMessage);
	// update image for next step
	var spanner = document.getElementById('taskStepText|' + taskID + '|' + (stepIndex+1));
	if (spanner != null)  
	{
	  spanner.className = "stepRunning";
	}
}

function Resize() 
{
  if(document.body.clientWidth - 410 > 410)
  {
    Mobilizer.width = document.body.clientWidth - 341;    
  }
  
  if(document.body.clientHeight - 135 > 515)
  {
    Mobilizer.height = document.body.clientHeight - 135;
  }
    
  document.getElementById('loadingdiv').style.width = Mobilizer.width;
  document.getElementById('loadingdiv').style.height = Mobilizer.height;
    
  ControlDisabler.style.height = document.getElementById("tree").offsetHeight+25;
  ControlDisabler.style.top = 222;
  
  AnimationResize();
}

function StartUp()
{  
  InitializeModeButtons(Mobilizer);
  
  Resize();
  
  Mobilizer.UserInterfaceVisibility = false;
  
  DoneLoad();
  SetLoading();
  initMenu();
  
}
</script>
